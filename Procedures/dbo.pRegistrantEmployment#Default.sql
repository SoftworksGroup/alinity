SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[pRegistrantEmployment#Default]
	 @zContext                                   xml               = null                -- default values provided from client-tier (if any)
	,@SetFKDefaults                              bit               = 0                   -- when 1, mandatory FK's are returned as -1 instead of NULL
as
/*********************************************************************************************************************************
Procedure : dbo.pRegistrantEmployment#Default
Notice    : Copyright Â© 2019 Softworks Group Inc.
Summary   : provides a blank row with default values for presentation in the UI for "new" dbo.RegistrantEmployment records
-----------------------------------------------------------------------------------------------------------------------------------
Author    : Generated by DB Studio: pSprocGen | Designer: Tim Edlund
Version   : April 2019
-----------------------------------------------------------------------------------------------------------------------------------
Comments
--------
This procedure is used in maintenance of the dbo.RegistrantEmployment table. When a new record is to be added from the UI, this procedure
is called to return a blank record with default values. If the client-tier is providing the context for the insert, such as a parent
key value for the new record, it must be passed in the @zContext XML parameter. Multiple values may be passed. The standard format
is: <Parameters MyParameter="1000001"/>.

The @SetFKDefaults parameter can be set to 1 to cause the procedure to return mandatory FK values as -1 rather than NULL. This avoids
the need to create complex types for the procedure on architectures which are not using RIA services.

Note that default values for text, ntext and binary type columns is not supported.  These data types are not permitted as local
variables in the current version of SQL Server and should be replaced by varchar(max) and nvarchar(max) where possible.

Some default values are built-in to the shell of the sproc.  The base table column defaults set in the variable declarations below
were obtained from database default constraints which existed at the time the procedure was generated. The declarations include all
columns of the vRegistrantEmployment entity view, however, only some values (as noted above) are eligible for default setting.  The other
parameters are included for setting context for the table-specific or client-specific logic of the procedure (if any). Default values
returning a question mark "?", system date, or 0 are provided for non-base table columns which are mandatory.  This is done to avoid
compilation errors from the Entity Framework, however, the values will not be applied since they are not in the base table row.

Two levels of customization of the procedure shell are supported. Table-specific logic can be added through the tagged section and a
call to an extended procedure supports client-specific customization. Logic implemented within the code tags is part of the base
product and applies to all client configurations. Client-specific customizations must be implemented in the ext.pRegistrantEmployment
procedure. The extended procedure is only called where it exists in database. The parameter "@Mode" is set to "default.pre" to
advise ext.pRegistrantEmployment of the context of the call. All other parameters are also passed, however, only those parameters eligible
for default setting are passed for "output". All parameters corresponding to entity view columns are returned through a SELECT statement.

In order to simplify working with the XML parameter values, logic in the procedure parses the XML and assigns values to variables where
the variable name matches the column name in the XML (assumes single row).  The variables are then available to the table-specific and
client-specific logic.  The @zContext parameter is also passed, unmodified, to the extended procedure to support situations where values
are passed that are not mapped to column names.


-------------------------------------------------------------------------------------------------------------------------------- */

begin
	set nocount on

	declare
		 @errorNo                                      int = 0								-- 0 no error, <50000 SQL error, else business rule
		,@tranCount                                    int = @@trancount			-- determines whether a wrapping transaction exists
		,@sprocName                                    nvarchar(128) = object_name(@@procid)						-- name of currently executing procedure
		,@xState                                       int										-- error state detected in catch block
		,@ON                                         bit = cast(1 as bit)			-- constant for bit comparisons
		,@OFF                                        bit = cast(0 as bit)			-- constant for bit comparisons
		,@registrantEmploymentSID                    int               = -1		-- specific default required by EF - do not override
		,@registrantSID                              int               = null	-- no default provided from DB constraint - OK to override
		,@orgSID                                     int               = null	-- no default provided from DB constraint - OK to override
		,@registrationYear                           smallint          = sf.fTodayYear()								-- default provided from DB constraint - OK to override
		,@employmentTypeSID                          int               = null	-- no default provided from DB constraint - OK to override
		,@employmentRoleSID                          int               = null	-- no default provided from DB constraint - OK to override
		,@practiceHours                              int               = (0)	-- default provided from DB constraint - OK to override
		,@practiceScopeSID                           int               = null	-- no default provided from DB constraint - OK to override
		,@ageRangeSID                                int               = null	-- no default provided from DB constraint - OK to override
		,@isOnPublicRegistry                         bit               = CONVERT(bit,(1))								-- default provided from DB constraint - OK to override
		,@phone                                      varchar(25)       = null	-- no default provided from DB constraint - OK to override
		,@siteLocation                               nvarchar(50)      = null	-- no default provided from DB constraint - OK to override
		,@effectiveTime                              datetime          = null	-- no default provided from DB constraint - OK to override
		,@expiryTime                                 datetime          = null	-- no default provided from DB constraint - OK to override
		,@rank                                       smallint          = (5)	-- default provided from DB constraint - OK to override
		,@ownershipPercentage                        smallint          = (0)	-- default provided from DB constraint - OK to override
		,@isEmployerInsurance                        bit               = CONVERT(bit,(0))								-- default provided from DB constraint - OK to override
		,@insuranceOrgSID                            int               = null	-- no default provided from DB constraint - OK to override
		,@insurancePolicyNo                          varchar(25)       = null	-- no default provided from DB constraint - OK to override
		,@insuranceAmount                            decimal(11,2)     = null	-- no default provided from DB constraint - OK to override
		,@userDefinedColumns                         xml               = null	-- no default provided from DB constraint - OK to override
		,@registrantEmploymentXID                    varchar(150)      = null	-- no default provided from DB constraint - OK to override
		,@legacyKey                                  nvarchar(50)      = null	-- no default provided from DB constraint - OK to override
		,@isDeleted                                  bit               = (0)	-- default provided from DB constraint - OK to override
		,@createUser                                 nvarchar(75)      = suser_sname()									-- default value ignored (value set by UI)
		,@createTime                                 datetimeoffset(7) = sysdatetimeoffset()						-- default value ignored (set to system time)
		,@updateUser                                 nvarchar(75)      = suser_sname()									-- default value ignored (value set by UI)
		,@updateTime                                 datetimeoffset(7) = sysdatetimeoffset()						-- default value ignored (set to system time)
		,@rowGUID                                    uniqueidentifier  = newid()												-- default value ignored (value set by system)
		,@rowStamp                                   timestamp         = null	-- default value ignored (value set by system)
		,@ageRangeTypeSID                            int               = 0		-- not a base table column (default ignored)
		,@ageRangeLabel                              nvarchar(35)      = N'?'	-- not a base table column (default ignored)
		,@startAge                                   smallint          = 0		-- not a base table column (default ignored)
		,@endAge                                     smallint          = 0		-- not a base table column (default ignored)
		,@ageRangeIsDefault                          bit               = 0		-- not a base table column (default ignored)
		,@ageRangeRowGUID                            uniqueidentifier  = newid()												-- not a base table column (default ignored)
		,@employmentRoleName                         nvarchar(50)      = N'?'	-- not a base table column (default ignored)
		,@employmentRoleCode                         varchar(20)       = '?'	-- not a base table column (default ignored)
		,@employmentRoleIsDefault                    bit               = 0		-- not a base table column (default ignored)
		,@employmentRoleIsActive                     bit               = 0		-- not a base table column (default ignored)
		,@employmentRoleRowGUID                      uniqueidentifier  = newid()												-- not a base table column (default ignored)
		,@employmentTypeName                         nvarchar(50)      = N'?'	-- not a base table column (default ignored)
		,@employmentTypeCode                         varchar(20)       = '?'	-- not a base table column (default ignored)
		,@employmentTypeCategory                     nvarchar(65)							-- not a base table column (default ignored)
		,@employmentTypeIsDefault                    bit               = 0		-- not a base table column (default ignored)
		,@employmentTypeIsActive                     bit               = 0		-- not a base table column (default ignored)
		,@employmentTypeRowGUID                      uniqueidentifier  = newid()												-- not a base table column (default ignored)
		,@orgParentOrgSID                            int											-- not a base table column (default ignored)
		,@orgOrgTypeSID                              int               = 0		-- not a base table column (default ignored)
		,@orgOrgName                                 nvarchar(150)     = N'?'	-- not a base table column (default ignored)
		,@orgOrgLabel                                nvarchar(35)      = N'?'	-- not a base table column (default ignored)
		,@orgStreetAddress1                          nvarchar(75)      = N'?'	-- not a base table column (default ignored)
		,@orgStreetAddress2                          nvarchar(75)							-- not a base table column (default ignored)
		,@orgStreetAddress3                          nvarchar(75)							-- not a base table column (default ignored)
		,@orgCitySID                                 int               = 0		-- not a base table column (default ignored)
		,@orgPostalCode                              varchar(10)       = '?'	-- not a base table column (default ignored)
		,@orgRegionSID                               int               = 0		-- not a base table column (default ignored)
		,@orgPhone                                   varchar(25)							-- not a base table column (default ignored)
		,@orgFax                                     varchar(25)							-- not a base table column (default ignored)
		,@orgWebSite                                 varchar(250)							-- not a base table column (default ignored)
		,@orgEmailAddress                            varchar(150)							-- not a base table column (default ignored)
		,@orgInsuranceOrgSID                         int											-- not a base table column (default ignored)
		,@orgInsurancePolicyNo                       varchar(25)							-- not a base table column (default ignored)
		,@orgInsuranceAmount                         decimal(11,2)						-- not a base table column (default ignored)
		,@orgIsEmployer                              bit               = 0		-- not a base table column (default ignored)
		,@orgIsCredentialAuthority                   bit               = 0		-- not a base table column (default ignored)
		,@orgIsInsurer                               bit               = 0		-- not a base table column (default ignored)
		,@orgIsInsuranceCertificateRequired          bit               = 0		-- not a base table column (default ignored)
		,@orgIsPublic                                nchar(10)								-- not a base table column (default ignored)
		,@orgIsActive                                bit               = 0		-- not a base table column (default ignored)
		,@orgIsAdminReviewRequired                   bit               = 0		-- not a base table column (default ignored)
		,@orgLastVerifiedTime                        datetimeoffset(7)				-- not a base table column (default ignored)
		,@orgRowGUID                                 uniqueidentifier  = newid()												-- not a base table column (default ignored)
		,@practiceScopeName                          nvarchar(50)      = N'?'	-- not a base table column (default ignored)
		,@practiceScopeCode                          varchar(20)       = '?'	-- not a base table column (default ignored)
		,@practiceScopeIsDefault                     bit               = 0		-- not a base table column (default ignored)
		,@practiceScopeIsActive                      bit               = 0		-- not a base table column (default ignored)
		,@practiceScopeRowGUID                       uniqueidentifier  = newid()												-- not a base table column (default ignored)
		,@personSID                                  int               = 0		-- not a base table column (default ignored)
		,@registrantNo                               varchar(50)       = '?'	-- not a base table column (default ignored)
		,@yearOfInitialEmployment                    smallint									-- not a base table column (default ignored)
		,@registrantIsOnPublicRegistry               bit               = 0		-- not a base table column (default ignored)
		,@cityNameOfBirth                            nvarchar(30)							-- not a base table column (default ignored)
		,@countrySID                                 int											-- not a base table column (default ignored)
		,@directedAuditYearCompetence                smallint									-- not a base table column (default ignored)
		,@directedAuditYearPracticeHours             smallint									-- not a base table column (default ignored)
		,@lateFeeExclusionYear                       smallint									-- not a base table column (default ignored)
		,@isRenewalAutoApprovalBlocked               bit               = 0		-- not a base table column (default ignored)
		,@renewalExtensionExpiryTime                 datetime									-- not a base table column (default ignored)
		,@archivedTime                               datetimeoffset(7)				-- not a base table column (default ignored)
		,@registrantRowGUID                          uniqueidentifier  = newid()												-- not a base table column (default ignored)
		,@orgInsuranceParentOrgSID                   int											-- not a base table column (default ignored)
		,@orgInsuranceOrgTypeSID                     int											-- not a base table column (default ignored)
		,@orgInsuranceOrgName                        nvarchar(150)						-- not a base table column (default ignored)
		,@orgInsuranceOrgLabel                       nvarchar(35)							-- not a base table column (default ignored)
		,@orgInsuranceStreetAddress1                 nvarchar(75)							-- not a base table column (default ignored)
		,@orgInsuranceStreetAddress2                 nvarchar(75)							-- not a base table column (default ignored)
		,@orgInsuranceStreetAddress3                 nvarchar(75)							-- not a base table column (default ignored)
		,@orgInsuranceCitySID                        int											-- not a base table column (default ignored)
		,@orgInsurancePostalCode                     varchar(10)							-- not a base table column (default ignored)
		,@orgInsuranceRegionSID                      int											-- not a base table column (default ignored)
		,@orgInsurancePhone                          varchar(25)							-- not a base table column (default ignored)
		,@orgInsuranceFax                            varchar(25)							-- not a base table column (default ignored)
		,@orgInsuranceWebSite                        varchar(250)							-- not a base table column (default ignored)
		,@orgInsuranceEmailAddress                   varchar(150)							-- not a base table column (default ignored)
		,@orgInsuranceInsuranceOrgSID                int											-- not a base table column (default ignored)
		,@orgInsuranceInsurancePolicyNo              varchar(25)							-- not a base table column (default ignored)
		,@orgInsuranceInsuranceAmount                decimal(11,2)						-- not a base table column (default ignored)
		,@orgInsuranceIsEmployer                     bit											-- not a base table column (default ignored)
		,@orgInsuranceIsCredentialAuthority          bit											-- not a base table column (default ignored)
		,@orgInsuranceIsInsurer                      bit											-- not a base table column (default ignored)
		,@orgInsuranceIsInsuranceCertificateRequired bit											-- not a base table column (default ignored)
		,@orgInsuranceIsPublic                       nchar(10)								-- not a base table column (default ignored)
		,@orgInsuranceIsActive                       bit											-- not a base table column (default ignored)
		,@orgInsuranceIsAdminReviewRequired          bit											-- not a base table column (default ignored)
		,@orgInsuranceLastVerifiedTime               datetimeoffset(7)				-- not a base table column (default ignored)
		,@orgInsuranceRowGUID                        uniqueidentifier					-- not a base table column (default ignored)
		,@isActive                                   bit											-- not a base table column (default ignored)
		,@isPending                                  bit											-- not a base table column (default ignored)
		,@isDeleteEnabled                            bit											-- not a base table column (default ignored)
		,@isReselected                               tinyint           = 1		-- specific default required by EF - do not override
		,@isNullApplied                              bit               = 1		-- specific default required by EF - do not override
		,@isSelfEmployed                             bit											-- not a base table column (default ignored)
		,@employmentRankNo                           int											-- not a base table column (default ignored)
		,@primaryPracticeAreaSID                     int											-- not a base table column (default ignored)
		,@primaryPracticeAreaName                    nvarchar(50)							-- not a base table column (default ignored)
		,@primaryPracticeAreaCode                    varchar(20)							-- not a base table column (default ignored)
		,@isPracticeScopeRequired                    bit											-- not a base table column (default ignored)
		,@employmentSupervisorSID                    int											-- not a base table column (default ignored)
		,@supervisorPersonSID                        int											-- not a base table column (default ignored)
		,@isPrivateInsurance                         bit											-- not a base table column (default ignored)
		,@effectiveInsuranceProviderName             nvarchar(150)						-- not a base table column (default ignored)
		,@effectiveInsurancePolicyNo                 varchar(25)							-- not a base table column (default ignored)
		,@effectiveInsuranceAmount                   decimal(11,2)						-- not a base table column (default ignored)

	begin try

		-- use a transaction so that any additional updates implemented through the extended
		-- procedure or through table-specific logic succeed or fail as a logical unit

		if @tranCount = 0																											-- no outer transaction
		begin
			begin transaction
		end
		else																																	-- outer transaction so create save point
		begin
			save transaction @sprocName
		end
		-- set mandatory FK values to -1 where requested
		
		if @SetFKDefaults = @ON
		begin
			set @registrantSID = -1
			set @orgSID = -1
			set @employmentTypeSID = -1
			set @employmentRoleSID = -1
			set @practiceScopeSID = -1
			set @ageRangeSID = -1
		end

		-- assign literal defaults passed through @zContext where
		-- provided otherwise leave database default in place
		
		select
			 @registrantSID            = isnull(context.node.value('@RegistrantSID'          ,'int'          ),@registrantSID)
			,@orgSID                   = isnull(context.node.value('@OrgSID'                 ,'int'          ),@orgSID)
			,@registrationYear         = isnull(context.node.value('@RegistrationYear'       ,'smallint'     ),@registrationYear)
			,@employmentTypeSID        = isnull(context.node.value('@EmploymentTypeSID'      ,'int'          ),@employmentTypeSID)
			,@employmentRoleSID        = isnull(context.node.value('@EmploymentRoleSID'      ,'int'          ),@employmentRoleSID)
			,@practiceHours            = isnull(context.node.value('@PracticeHours'          ,'int'          ),@practiceHours)
			,@practiceScopeSID         = isnull(context.node.value('@PracticeScopeSID'       ,'int'          ),@practiceScopeSID)
			,@ageRangeSID              = isnull(context.node.value('@AgeRangeSID'            ,'int'          ),@ageRangeSID)
			,@isOnPublicRegistry       = isnull(context.node.value('@IsOnPublicRegistry'     ,'bit'          ),@isOnPublicRegistry)
			,@phone                    = isnull(context.node.value('@Phone'                  ,'varchar(25)'  ),@phone)
			,@siteLocation             = isnull(context.node.value('@SiteLocation'           ,'nvarchar(50)' ),@siteLocation)
			,@effectiveTime            = isnull(context.node.value('@EffectiveTime'          ,'datetime'     ),@effectiveTime)
			,@expiryTime               = isnull(context.node.value('@ExpiryTime'             ,'datetime'     ),@expiryTime)
			,@rank                     = isnull(context.node.value('@Rank'                   ,'smallint'     ),@rank)
			,@ownershipPercentage      = isnull(context.node.value('@OwnershipPercentage'    ,'smallint'     ),@ownershipPercentage)
			,@isEmployerInsurance      = isnull(context.node.value('@IsEmployerInsurance'    ,'bit'          ),@isEmployerInsurance)
			,@insuranceOrgSID          = isnull(context.node.value('@InsuranceOrgSID'        ,'int'          ),@insuranceOrgSID)
			,@insurancePolicyNo        = isnull(context.node.value('@InsurancePolicyNo'      ,'varchar(25)'  ),@insurancePolicyNo)
			,@insuranceAmount          = isnull(context.node.value('@InsuranceAmount'        ,'decimal(11,2)'),@insuranceAmount)
			,@registrantEmploymentXID  = isnull(context.node.value('@RegistrantEmploymentXID','varchar(150)' ),@registrantEmploymentXID)
			,@legacyKey                = isnull(context.node.value('@LegacyKey'              ,'nvarchar(50)' ),@legacyKey)
		from
			@zContext.nodes('Parameters') as context(node)
		
		set @effectiveTime = sf.fToday()																			-- default effective time to current date
		
		-- set default value on foreign keys where configured
		-- and where no DB or literal value was passed for it
		
		if isnull(@ageRangeSID      ,0) = 0 select @ageRangeSID       = x.AgeRangeSID       from dbo.AgeRange       x where x.IsDefault = @ON
		if isnull(@employmentRoleSID,0) = 0 select @employmentRoleSID = x.EmploymentRoleSID from dbo.EmploymentRole x where x.IsDefault = @ON
		if isnull(@employmentTypeSID,0) = 0 select @employmentTypeSID = x.EmploymentTypeSID from dbo.EmploymentType x where x.IsDefault = @ON
		if isnull(@practiceScopeSID ,0) = 0 select @practiceScopeSID  = x.PracticeScopeSID  from dbo.PracticeScope  x where x.IsDefault = @ON

		--! <Overrides>
		--  insert default value logic here ...
		--! </Overrides>
	
		-- call the extended version of the procedure (if it exists) for "default.pre" mode
		
		if exists
		(
			select
				1
			from
				sf.vRoutine r
			where
				r.SchemaName = 'ext'
			and
				r.RoutineName = 'pRegistrantEmployment'
		)
		begin
		
			exec @errorNo = ext.pRegistrantEmployment
				 @Mode                                       = 'default.pre'
				,@RegistrantEmploymentSID = @registrantEmploymentSID
				,@RegistrantSID = @registrantSID output
				,@OrgSID = @orgSID output
				,@RegistrationYear = @registrationYear output
				,@EmploymentTypeSID = @employmentTypeSID output
				,@EmploymentRoleSID = @employmentRoleSID output
				,@PracticeHours = @practiceHours output
				,@PracticeScopeSID = @practiceScopeSID output
				,@AgeRangeSID = @ageRangeSID output
				,@IsOnPublicRegistry = @isOnPublicRegistry output
				,@Phone = @phone output
				,@SiteLocation = @siteLocation output
				,@EffectiveTime = @effectiveTime output
				,@ExpiryTime = @expiryTime output
				,@Rank = @rank output
				,@OwnershipPercentage = @ownershipPercentage output
				,@IsEmployerInsurance = @isEmployerInsurance output
				,@InsuranceOrgSID = @insuranceOrgSID output
				,@InsurancePolicyNo = @insurancePolicyNo output
				,@InsuranceAmount = @insuranceAmount output
				,@UserDefinedColumns = @userDefinedColumns output
				,@RegistrantEmploymentXID = @registrantEmploymentXID output
				,@LegacyKey = @legacyKey output
				,@IsDeleted = @isDeleted
				,@CreateUser = @createUser
				,@CreateTime = @createTime
				,@UpdateUser = @updateUser
				,@UpdateTime = @updateTime
				,@RowGUID = @rowGUID
				,@RowStamp = @rowStamp
				,@AgeRangeTypeSID = @ageRangeTypeSID
				,@AgeRangeLabel = @ageRangeLabel
				,@StartAge = @startAge
				,@EndAge = @endAge
				,@AgeRangeIsDefault = @ageRangeIsDefault
				,@AgeRangeRowGUID = @ageRangeRowGUID
				,@EmploymentRoleName = @employmentRoleName
				,@EmploymentRoleCode = @employmentRoleCode
				,@EmploymentRoleIsDefault = @employmentRoleIsDefault
				,@EmploymentRoleIsActive = @employmentRoleIsActive
				,@EmploymentRoleRowGUID = @employmentRoleRowGUID
				,@EmploymentTypeName = @employmentTypeName
				,@EmploymentTypeCode = @employmentTypeCode
				,@EmploymentTypeCategory = @employmentTypeCategory
				,@EmploymentTypeIsDefault = @employmentTypeIsDefault
				,@EmploymentTypeIsActive = @employmentTypeIsActive
				,@EmploymentTypeRowGUID = @employmentTypeRowGUID
				,@OrgParentOrgSID = @orgParentOrgSID
				,@OrgOrgTypeSID = @orgOrgTypeSID
				,@OrgOrgName = @orgOrgName
				,@OrgOrgLabel = @orgOrgLabel
				,@OrgStreetAddress1 = @orgStreetAddress1
				,@OrgStreetAddress2 = @orgStreetAddress2
				,@OrgStreetAddress3 = @orgStreetAddress3
				,@OrgCitySID = @orgCitySID
				,@OrgPostalCode = @orgPostalCode
				,@OrgRegionSID = @orgRegionSID
				,@OrgPhone = @orgPhone
				,@OrgFax = @orgFax
				,@OrgWebSite = @orgWebSite
				,@OrgEmailAddress = @orgEmailAddress
				,@OrgInsuranceOrgSID = @orgInsuranceOrgSID
				,@OrgInsurancePolicyNo = @orgInsurancePolicyNo
				,@OrgInsuranceAmount = @orgInsuranceAmount
				,@OrgIsEmployer = @orgIsEmployer
				,@OrgIsCredentialAuthority = @orgIsCredentialAuthority
				,@OrgIsInsurer = @orgIsInsurer
				,@OrgIsInsuranceCertificateRequired = @orgIsInsuranceCertificateRequired
				,@OrgIsPublic = @orgIsPublic
				,@OrgIsActive = @orgIsActive
				,@OrgIsAdminReviewRequired = @orgIsAdminReviewRequired
				,@OrgLastVerifiedTime = @orgLastVerifiedTime
				,@OrgRowGUID = @orgRowGUID
				,@PracticeScopeName = @practiceScopeName
				,@PracticeScopeCode = @practiceScopeCode
				,@PracticeScopeIsDefault = @practiceScopeIsDefault
				,@PracticeScopeIsActive = @practiceScopeIsActive
				,@PracticeScopeRowGUID = @practiceScopeRowGUID
				,@PersonSID = @personSID
				,@RegistrantNo = @registrantNo
				,@YearOfInitialEmployment = @yearOfInitialEmployment
				,@RegistrantIsOnPublicRegistry = @registrantIsOnPublicRegistry
				,@CityNameOfBirth = @cityNameOfBirth
				,@CountrySID = @countrySID
				,@DirectedAuditYearCompetence = @directedAuditYearCompetence
				,@DirectedAuditYearPracticeHours = @directedAuditYearPracticeHours
				,@LateFeeExclusionYear = @lateFeeExclusionYear
				,@IsRenewalAutoApprovalBlocked = @isRenewalAutoApprovalBlocked
				,@RenewalExtensionExpiryTime = @renewalExtensionExpiryTime
				,@ArchivedTime = @archivedTime
				,@RegistrantRowGUID = @registrantRowGUID
				,@OrgInsuranceParentOrgSID = @orgInsuranceParentOrgSID
				,@OrgInsuranceOrgTypeSID = @orgInsuranceOrgTypeSID
				,@OrgInsuranceOrgName = @orgInsuranceOrgName
				,@OrgInsuranceOrgLabel = @orgInsuranceOrgLabel
				,@OrgInsuranceStreetAddress1 = @orgInsuranceStreetAddress1
				,@OrgInsuranceStreetAddress2 = @orgInsuranceStreetAddress2
				,@OrgInsuranceStreetAddress3 = @orgInsuranceStreetAddress3
				,@OrgInsuranceCitySID = @orgInsuranceCitySID
				,@OrgInsurancePostalCode = @orgInsurancePostalCode
				,@OrgInsuranceRegionSID = @orgInsuranceRegionSID
				,@OrgInsurancePhone = @orgInsurancePhone
				,@OrgInsuranceFax = @orgInsuranceFax
				,@OrgInsuranceWebSite = @orgInsuranceWebSite
				,@OrgInsuranceEmailAddress = @orgInsuranceEmailAddress
				,@OrgInsuranceInsuranceOrgSID = @orgInsuranceInsuranceOrgSID
				,@OrgInsuranceInsurancePolicyNo = @orgInsuranceInsurancePolicyNo
				,@OrgInsuranceInsuranceAmount = @orgInsuranceInsuranceAmount
				,@OrgInsuranceIsEmployer = @orgInsuranceIsEmployer
				,@OrgInsuranceIsCredentialAuthority = @orgInsuranceIsCredentialAuthority
				,@OrgInsuranceIsInsurer = @orgInsuranceIsInsurer
				,@OrgInsuranceIsInsuranceCertificateRequired = @orgInsuranceIsInsuranceCertificateRequired
				,@OrgInsuranceIsPublic = @orgInsuranceIsPublic
				,@OrgInsuranceIsActive = @orgInsuranceIsActive
				,@OrgInsuranceIsAdminReviewRequired = @orgInsuranceIsAdminReviewRequired
				,@OrgInsuranceLastVerifiedTime = @orgInsuranceLastVerifiedTime
				,@OrgInsuranceRowGUID = @orgInsuranceRowGUID
				,@IsActive = @isActive
				,@IsPending = @isPending
				,@IsDeleteEnabled = @isDeleteEnabled
				,@IsReselected = @isReselected
				,@IsNullApplied = @isNullApplied
				,@zContext = @zContext output
				,@IsSelfEmployed = @isSelfEmployed
				,@EmploymentRankNo = @employmentRankNo
				,@PrimaryPracticeAreaSID = @primaryPracticeAreaSID
				,@PrimaryPracticeAreaName = @primaryPracticeAreaName
				,@PrimaryPracticeAreaCode = @primaryPracticeAreaCode
				,@IsPracticeScopeRequired = @isPracticeScopeRequired
				,@EmploymentSupervisorSID = @employmentSupervisorSID
				,@SupervisorPersonSID = @supervisorPersonSID
				,@IsPrivateInsurance = @isPrivateInsurance
				,@EffectiveInsuranceProviderName = @effectiveInsuranceProviderName
				,@EffectiveInsurancePolicyNo = @effectiveInsurancePolicyNo
				,@EffectiveInsuranceAmount = @effectiveInsuranceAmount
		
		end

		select
			 @registrantEmploymentSID RegistrantEmploymentSID
			,@registrantSID RegistrantSID
			,@orgSID OrgSID
			,@registrationYear RegistrationYear
			,@employmentTypeSID EmploymentTypeSID
			,@employmentRoleSID EmploymentRoleSID
			,@practiceHours PracticeHours
			,@practiceScopeSID PracticeScopeSID
			,@ageRangeSID AgeRangeSID
			,@isOnPublicRegistry IsOnPublicRegistry
			,@phone Phone
			,@siteLocation SiteLocation
			,@effectiveTime EffectiveTime
			,@expiryTime ExpiryTime
			,@rank Rank
			,@ownershipPercentage OwnershipPercentage
			,@isEmployerInsurance IsEmployerInsurance
			,@insuranceOrgSID InsuranceOrgSID
			,@insurancePolicyNo InsurancePolicyNo
			,@insuranceAmount InsuranceAmount
			,@userDefinedColumns UserDefinedColumns
			,@registrantEmploymentXID RegistrantEmploymentXID
			,@legacyKey LegacyKey
			,@isDeleted IsDeleted
			,@createUser CreateUser
			,@createTime CreateTime
			,@updateUser UpdateUser
			,@updateTime UpdateTime
			,@rowGUID RowGUID
			,@rowStamp RowStamp
			,@ageRangeTypeSID AgeRangeTypeSID
			,@ageRangeLabel AgeRangeLabel
			,@startAge StartAge
			,@endAge EndAge
			,@ageRangeIsDefault AgeRangeIsDefault
			,@ageRangeRowGUID AgeRangeRowGUID
			,@employmentRoleName EmploymentRoleName
			,@employmentRoleCode EmploymentRoleCode
			,@employmentRoleIsDefault EmploymentRoleIsDefault
			,@employmentRoleIsActive EmploymentRoleIsActive
			,@employmentRoleRowGUID EmploymentRoleRowGUID
			,@employmentTypeName EmploymentTypeName
			,@employmentTypeCode EmploymentTypeCode
			,@employmentTypeCategory EmploymentTypeCategory
			,@employmentTypeIsDefault EmploymentTypeIsDefault
			,@employmentTypeIsActive EmploymentTypeIsActive
			,@employmentTypeRowGUID EmploymentTypeRowGUID
			,@orgParentOrgSID OrgParentOrgSID
			,@orgOrgTypeSID OrgOrgTypeSID
			,@orgOrgName OrgOrgName
			,@orgOrgLabel OrgOrgLabel
			,@orgStreetAddress1 OrgStreetAddress1
			,@orgStreetAddress2 OrgStreetAddress2
			,@orgStreetAddress3 OrgStreetAddress3
			,@orgCitySID OrgCitySID
			,@orgPostalCode OrgPostalCode
			,@orgRegionSID OrgRegionSID
			,@orgPhone OrgPhone
			,@orgFax OrgFax
			,@orgWebSite OrgWebSite
			,@orgEmailAddress OrgEmailAddress
			,@orgInsuranceOrgSID OrgInsuranceOrgSID
			,@orgInsurancePolicyNo OrgInsurancePolicyNo
			,@orgInsuranceAmount OrgInsuranceAmount
			,@orgIsEmployer OrgIsEmployer
			,@orgIsCredentialAuthority OrgIsCredentialAuthority
			,@orgIsInsurer OrgIsInsurer
			,@orgIsInsuranceCertificateRequired OrgIsInsuranceCertificateRequired
			,@orgIsPublic OrgIsPublic
			,@orgIsActive OrgIsActive
			,@orgIsAdminReviewRequired OrgIsAdminReviewRequired
			,@orgLastVerifiedTime OrgLastVerifiedTime
			,@orgRowGUID OrgRowGUID
			,@practiceScopeName PracticeScopeName
			,@practiceScopeCode PracticeScopeCode
			,@practiceScopeIsDefault PracticeScopeIsDefault
			,@practiceScopeIsActive PracticeScopeIsActive
			,@practiceScopeRowGUID PracticeScopeRowGUID
			,@personSID PersonSID
			,@registrantNo RegistrantNo
			,@yearOfInitialEmployment YearOfInitialEmployment
			,@registrantIsOnPublicRegistry RegistrantIsOnPublicRegistry
			,@cityNameOfBirth CityNameOfBirth
			,@countrySID CountrySID
			,@directedAuditYearCompetence DirectedAuditYearCompetence
			,@directedAuditYearPracticeHours DirectedAuditYearPracticeHours
			,@lateFeeExclusionYear LateFeeExclusionYear
			,@isRenewalAutoApprovalBlocked IsRenewalAutoApprovalBlocked
			,@renewalExtensionExpiryTime RenewalExtensionExpiryTime
			,@archivedTime ArchivedTime
			,@registrantRowGUID RegistrantRowGUID
			,@orgInsuranceParentOrgSID OrgInsuranceParentOrgSID
			,@orgInsuranceOrgTypeSID OrgInsuranceOrgTypeSID
			,@orgInsuranceOrgName OrgInsuranceOrgName
			,@orgInsuranceOrgLabel OrgInsuranceOrgLabel
			,@orgInsuranceStreetAddress1 OrgInsuranceStreetAddress1
			,@orgInsuranceStreetAddress2 OrgInsuranceStreetAddress2
			,@orgInsuranceStreetAddress3 OrgInsuranceStreetAddress3
			,@orgInsuranceCitySID OrgInsuranceCitySID
			,@orgInsurancePostalCode OrgInsurancePostalCode
			,@orgInsuranceRegionSID OrgInsuranceRegionSID
			,@orgInsurancePhone OrgInsurancePhone
			,@orgInsuranceFax OrgInsuranceFax
			,@orgInsuranceWebSite OrgInsuranceWebSite
			,@orgInsuranceEmailAddress OrgInsuranceEmailAddress
			,@orgInsuranceInsuranceOrgSID OrgInsuranceInsuranceOrgSID
			,@orgInsuranceInsurancePolicyNo OrgInsuranceInsurancePolicyNo
			,@orgInsuranceInsuranceAmount OrgInsuranceInsuranceAmount
			,@orgInsuranceIsEmployer OrgInsuranceIsEmployer
			,@orgInsuranceIsCredentialAuthority OrgInsuranceIsCredentialAuthority
			,@orgInsuranceIsInsurer OrgInsuranceIsInsurer
			,@orgInsuranceIsInsuranceCertificateRequired OrgInsuranceIsInsuranceCertificateRequired
			,@orgInsuranceIsPublic OrgInsuranceIsPublic
			,@orgInsuranceIsActive OrgInsuranceIsActive
			,@orgInsuranceIsAdminReviewRequired OrgInsuranceIsAdminReviewRequired
			,@orgInsuranceLastVerifiedTime OrgInsuranceLastVerifiedTime
			,@orgInsuranceRowGUID OrgInsuranceRowGUID
			,@isActive IsActive
			,@isPending IsPending
			,@isDeleteEnabled IsDeleteEnabled
			,@isReselected IsReselected
			,@isNullApplied IsNullApplied
			,@zContext zContext
			,@isSelfEmployed IsSelfEmployed
			,@employmentRankNo EmploymentRankNo
			,@primaryPracticeAreaSID PrimaryPracticeAreaSID
			,@primaryPracticeAreaName PrimaryPracticeAreaName
			,@primaryPracticeAreaCode PrimaryPracticeAreaCode
			,@isPracticeScopeRequired IsPracticeScopeRequired
			,@employmentSupervisorSID EmploymentSupervisorSID
			,@supervisorPersonSID SupervisorPersonSID
			,@isPrivateInsurance IsPrivateInsurance
			,@effectiveInsuranceProviderName EffectiveInsuranceProviderName
			,@effectiveInsurancePolicyNo EffectiveInsurancePolicyNo
			,@effectiveInsuranceAmount EffectiveInsuranceAmount

	end try

	begin catch
		set @xState = xact_state()
		
		if @tranCount > 0 and @xState = 1
		begin
			rollback transaction @sprocName																			-- committable wrapping trx exists: rollback to savepoint
		end
		else if @xState <> 0																									-- full rollback
		begin
			rollback
		end
		
		exec @errorNo = sf.pErrorRethrow																			-- process message text and re-throw the error
	end catch

	return(@errorNo)

end
GO
